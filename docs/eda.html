<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R (BGU course)</title>
  <meta name="description" content="Class notes for the R course at the BGU’s IE&amp;M dept.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="R (BGU course)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Class notes for the R course at the BGU’s IE&amp;M dept." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R (BGU course)" />
  
  <meta name="twitter:description" content="Class notes for the R course at the BGU’s IE&amp;M dept." />
  

<meta name="author" content="Jonathan D. Rosenblatt">


<meta name="date" content="2018-06-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="datatable.html">
<link rel="next" href="lm.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Course</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#notation-conventions"><i class="fa fa-check"></i><b>1.1</b> Notation Conventions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ecosystem"><i class="fa fa-check"></i><b>2.2</b> The R Ecosystem</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#bibliographic-notes"><i class="fa fa-check"></i><b>2.3</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#practice-yourself"><i class="fa fa-check"></i><b>2.4</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="3.0.1" data-path="basics.html"><a href="basics.html#other-ides"><i class="fa fa-check"></i><b>3.0.1</b> Other IDEs</a></li>
<li class="chapter" data-level="3.1" data-path="basics.html"><a href="basics.html#file-types"><i class="fa fa-check"></i><b>3.1</b> File types</a></li>
<li class="chapter" data-level="3.2" data-path="basics.html"><a href="basics.html#simple-calculator"><i class="fa fa-check"></i><b>3.2</b> Simple calculator</a></li>
<li class="chapter" data-level="3.3" data-path="basics.html"><a href="basics.html#probability-calculator"><i class="fa fa-check"></i><b>3.3</b> Probability calculator</a></li>
<li class="chapter" data-level="3.4" data-path="basics.html"><a href="basics.html#getting-help"><i class="fa fa-check"></i><b>3.4</b> Getting Help</a></li>
<li class="chapter" data-level="3.5" data-path="basics.html"><a href="basics.html#variable-asignment"><i class="fa fa-check"></i><b>3.5</b> Variable Asignment</a></li>
<li class="chapter" data-level="3.6" data-path="basics.html"><a href="basics.html#missing"><i class="fa fa-check"></i><b>3.6</b> Missing</a></li>
<li class="chapter" data-level="3.7" data-path="basics.html"><a href="basics.html#piping"><i class="fa fa-check"></i><b>3.7</b> Piping</a></li>
<li class="chapter" data-level="3.8" data-path="basics.html"><a href="basics.html#vector-creation-and-manipulation"><i class="fa fa-check"></i><b>3.8</b> Vector Creation and Manipulation</a></li>
<li class="chapter" data-level="3.9" data-path="basics.html"><a href="basics.html#search-paths-and-packages"><i class="fa fa-check"></i><b>3.9</b> Search Paths and Packages</a></li>
<li class="chapter" data-level="3.10" data-path="basics.html"><a href="basics.html#simple-plotting"><i class="fa fa-check"></i><b>3.10</b> Simple Plotting</a></li>
<li class="chapter" data-level="3.11" data-path="basics.html"><a href="basics.html#object-types"><i class="fa fa-check"></i><b>3.11</b> Object Types</a></li>
<li class="chapter" data-level="3.12" data-path="basics.html"><a href="basics.html#data-frames"><i class="fa fa-check"></i><b>3.12</b> Data Frames</a></li>
<li class="chapter" data-level="3.13" data-path="basics.html"><a href="basics.html#exctraction"><i class="fa fa-check"></i><b>3.13</b> Exctraction</a></li>
<li class="chapter" data-level="3.14" data-path="basics.html"><a href="basics.html#augmentations-of-the-data.frame-class"><i class="fa fa-check"></i><b>3.14</b> Augmentations of the data.frame class</a></li>
<li class="chapter" data-level="3.15" data-path="basics.html"><a href="basics.html#data-import-and-export"><i class="fa fa-check"></i><b>3.15</b> Data Import and Export</a><ul>
<li class="chapter" data-level="3.15.1" data-path="basics.html"><a href="basics.html#import-from-web"><i class="fa fa-check"></i><b>3.15.1</b> Import from WEB</a></li>
<li class="chapter" data-level="3.15.2" data-path="basics.html"><a href="basics.html#export-as-csv"><i class="fa fa-check"></i><b>3.15.2</b> Export as CSV</a></li>
<li class="chapter" data-level="3.15.3" data-path="basics.html"><a href="basics.html#export-non-csv-files"><i class="fa fa-check"></i><b>3.15.3</b> Export non-CSV files</a></li>
<li class="chapter" data-level="3.15.4" data-path="basics.html"><a href="basics.html#reading-from-text-files"><i class="fa fa-check"></i><b>3.15.4</b> Reading From Text Files</a></li>
<li class="chapter" data-level="3.15.5" data-path="basics.html"><a href="basics.html#writing-data-to-text-files"><i class="fa fa-check"></i><b>3.15.5</b> Writing Data to Text Files</a></li>
<li class="chapter" data-level="3.15.6" data-path="basics.html"><a href="basics.html#xlsx-files"><i class="fa fa-check"></i><b>3.15.6</b> .XLS(X) files</a></li>
<li class="chapter" data-level="3.15.7" data-path="basics.html"><a href="basics.html#massive-files"><i class="fa fa-check"></i><b>3.15.7</b> Massive files</a></li>
<li class="chapter" data-level="3.15.8" data-path="basics.html"><a href="basics.html#databases"><i class="fa fa-check"></i><b>3.15.8</b> Databases</a></li>
</ul></li>
<li class="chapter" data-level="3.16" data-path="basics.html"><a href="basics.html#functions"><i class="fa fa-check"></i><b>3.16</b> Functions</a></li>
<li class="chapter" data-level="3.17" data-path="basics.html"><a href="basics.html#looping"><i class="fa fa-check"></i><b>3.17</b> Looping</a></li>
<li class="chapter" data-level="3.18" data-path="basics.html"><a href="basics.html#apply"><i class="fa fa-check"></i><b>3.18</b> Apply</a></li>
<li class="chapter" data-level="3.19" data-path="basics.html"><a href="basics.html#recursion"><i class="fa fa-check"></i><b>3.19</b> Recursion</a></li>
<li class="chapter" data-level="3.20" data-path="basics.html"><a href="basics.html#dates-and-times"><i class="fa fa-check"></i><b>3.20</b> Dates and Times</a></li>
<li class="chapter" data-level="3.21" data-path="basics.html"><a href="basics.html#bibliographic-notes-1"><i class="fa fa-check"></i><b>3.21</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="3.22" data-path="basics.html"><a href="basics.html#practice-yourself-1"><i class="fa fa-check"></i><b>3.22</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datatable.html"><a href="datatable.html"><i class="fa fa-check"></i><b>4</b> data.table</a><ul>
<li class="chapter" data-level="4.1" data-path="datatable.html"><a href="datatable.html#make-your-own-variables"><i class="fa fa-check"></i><b>4.1</b> Make your own variables</a></li>
<li class="chapter" data-level="4.2" data-path="datatable.html"><a href="datatable.html#join"><i class="fa fa-check"></i><b>4.2</b> Join</a></li>
<li class="chapter" data-level="4.3" data-path="datatable.html"><a href="datatable.html#reshaping-data"><i class="fa fa-check"></i><b>4.3</b> Reshaping data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="datatable.html"><a href="datatable.html#wide-to-long"><i class="fa fa-check"></i><b>4.3.1</b> Wide to long</a></li>
<li class="chapter" data-level="4.3.2" data-path="datatable.html"><a href="datatable.html#long-to-wide"><i class="fa fa-check"></i><b>4.3.2</b> Long to wide</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="datatable.html"><a href="datatable.html#bibliographic-notes-2"><i class="fa fa-check"></i><b>4.4</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="4.5" data-path="datatable.html"><a href="datatable.html#practice-yourself-2"><i class="fa fa-check"></i><b>4.5</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>5</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="eda.html"><a href="eda.html#summary-statistics"><i class="fa fa-check"></i><b>5.1</b> Summary Statistics</a><ul>
<li class="chapter" data-level="5.1.1" data-path="eda.html"><a href="eda.html#categorical-data"><i class="fa fa-check"></i><b>5.1.1</b> Categorical Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="eda.html"><a href="eda.html#continous-data"><i class="fa fa-check"></i><b>5.1.2</b> Continous Data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="eda.html"><a href="eda.html#visualization"><i class="fa fa-check"></i><b>5.2</b> Visualization</a><ul>
<li class="chapter" data-level="5.2.1" data-path="eda.html"><a href="eda.html#categorical-data-1"><i class="fa fa-check"></i><b>5.2.1</b> Categorical Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="eda.html"><a href="eda.html#continuous-data"><i class="fa fa-check"></i><b>5.2.2</b> Continuous Data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="eda.html"><a href="eda.html#mixed-type-data"><i class="fa fa-check"></i><b>5.3</b> Mixed Type Data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="eda.html"><a href="eda.html#alluvian-diagram"><i class="fa fa-check"></i><b>5.3.1</b> Alluvian Diagram</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="eda.html"><a href="eda.html#bibliographic-notes-3"><i class="fa fa-check"></i><b>5.4</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="5.5" data-path="eda.html"><a href="eda.html#practice-yourself-3"><i class="fa fa-check"></i><b>5.5</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>6</b> Linear Models</a><ul>
<li class="chapter" data-level="6.1" data-path="lm.html"><a href="lm.html#problem-setup"><i class="fa fa-check"></i><b>6.1</b> Problem Setup</a></li>
<li class="chapter" data-level="6.2" data-path="lm.html"><a href="lm.html#ols-estimation-in-r"><i class="fa fa-check"></i><b>6.2</b> OLS Estimation in R</a></li>
<li class="chapter" data-level="6.3" data-path="lm.html"><a href="lm.html#inference"><i class="fa fa-check"></i><b>6.3</b> Inference</a><ul>
<li class="chapter" data-level="6.3.1" data-path="lm.html"><a href="lm.html#testing-a-hypothesis-on-a-single-coefficient"><i class="fa fa-check"></i><b>6.3.1</b> Testing a Hypothesis on a Single Coefficient</a></li>
<li class="chapter" data-level="6.3.2" data-path="lm.html"><a href="lm.html#constructing-a-confidence-interval-on-a-single-coefficient"><i class="fa fa-check"></i><b>6.3.2</b> Constructing a Confidence Interval on a Single Coefficient</a></li>
<li class="chapter" data-level="6.3.3" data-path="lm.html"><a href="lm.html#multiple-regression"><i class="fa fa-check"></i><b>6.3.3</b> Multiple Regression</a></li>
<li class="chapter" data-level="6.3.4" data-path="lm.html"><a href="lm.html#anova"><i class="fa fa-check"></i><b>6.3.4</b> ANOVA (*)</a></li>
<li class="chapter" data-level="6.3.5" data-path="lm.html"><a href="lm.html#testing-a-hypothesis-on-a-single-contrast"><i class="fa fa-check"></i><b>6.3.5</b> Testing a Hypothesis on a Single Contrast (*)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lm.html"><a href="lm.html#bibliographic-notes-4"><i class="fa fa-check"></i><b>6.4</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="6.5" data-path="lm.html"><a href="lm.html#practice-yourself-4"><i class="fa fa-check"></i><b>6.5</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="7.1" data-path="glm.html"><a href="glm.html#problem-setup-1"><i class="fa fa-check"></i><b>7.1</b> Problem Setup</a></li>
<li class="chapter" data-level="7.2" data-path="glm.html"><a href="glm.html#logistic-regression"><i class="fa fa-check"></i><b>7.2</b> Logistic Regression</a><ul>
<li class="chapter" data-level="7.2.1" data-path="glm.html"><a href="glm.html#logistic-regression-with-r"><i class="fa fa-check"></i><b>7.2.1</b> Logistic Regression with R</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="glm.html"><a href="glm.html#poisson-regression"><i class="fa fa-check"></i><b>7.3</b> Poisson Regression</a></li>
<li class="chapter" data-level="7.4" data-path="glm.html"><a href="glm.html#extensions"><i class="fa fa-check"></i><b>7.4</b> Extensions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="glm.html"><a href="glm.html#probit-regression-and-changing-the-link-function"><i class="fa fa-check"></i><b>7.4.1</b> Probit Regression and Changing the Link Function</a></li>
<li class="chapter" data-level="7.4.2" data-path="glm.html"><a href="glm.html#marginal-effects"><i class="fa fa-check"></i><b>7.4.2</b> Marginal Effects</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="glm.html"><a href="glm.html#bibliographic-notes-5"><i class="fa fa-check"></i><b>7.5</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="7.6" data-path="glm.html"><a href="glm.html#practice-glm"><i class="fa fa-check"></i><b>7.6</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lme.html"><a href="lme.html"><i class="fa fa-check"></i><b>8</b> Linear Mixed Models</a><ul>
<li class="chapter" data-level="8.1" data-path="lme.html"><a href="lme.html#problem-setup-2"><i class="fa fa-check"></i><b>8.1</b> Problem Setup</a><ul>
<li class="chapter" data-level="8.1.1" data-path="lme.html"><a href="lme.html#non-linear-mixed-models"><i class="fa fa-check"></i><b>8.1.1</b> Non-Linear Mixed Models</a></li>
<li class="chapter" data-level="8.1.2" data-path="lme.html"><a href="lme.html#generalized-linear-mixed-models-glmm"><i class="fa fa-check"></i><b>8.1.2</b> Generalized Linear Mixed Models (GLMM)</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="lme.html"><a href="lme.html#mixed-models-with-r"><i class="fa fa-check"></i><b>8.2</b> Mixed Models with R</a><ul>
<li class="chapter" data-level="8.2.1" data-path="lme.html"><a href="lme.html#a-single-random-effect"><i class="fa fa-check"></i><b>8.2.1</b> A Single Random Effect</a></li>
<li class="chapter" data-level="8.2.2" data-path="lme.html"><a href="lme.html#multiple-random-effects"><i class="fa fa-check"></i><b>8.2.2</b> Multiple Random Effects</a></li>
<li class="chapter" data-level="8.2.3" data-path="lme.html"><a href="lme.html#a-full-mixed-model"><i class="fa fa-check"></i><b>8.2.3</b> A Full Mixed-Model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="lme.html"><a href="lme.html#serial"><i class="fa fa-check"></i><b>8.3</b> Serial Correlations</a></li>
<li class="chapter" data-level="8.4" data-path="lme.html"><a href="lme.html#extensions-1"><i class="fa fa-check"></i><b>8.4</b> Extensions</a><ul>
<li class="chapter" data-level="8.4.1" data-path="lme.html"><a href="lme.html#cluster-robust-standard-errors"><i class="fa fa-check"></i><b>8.4.1</b> Cluster Robust Standard Errors</a></li>
<li class="chapter" data-level="8.4.2" data-path="lme.html"><a href="lme.html#linear-models-for-panel-data"><i class="fa fa-check"></i><b>8.4.2</b> Linear Models for Panel Data</a></li>
<li class="chapter" data-level="8.4.3" data-path="lme.html"><a href="lme.html#testing-hypotheses-on-correlations"><i class="fa fa-check"></i><b>8.4.3</b> Testing Hypotheses on Correlations</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="lme.html"><a href="lme.html#relation-to-other-estimators"><i class="fa fa-check"></i><b>8.5</b> Relation to Other Estimators</a><ul>
<li class="chapter" data-level="8.5.1" data-path="lme.html"><a href="lme.html#fixed-effects-in-the-econometric-literature"><i class="fa fa-check"></i><b>8.5.1</b> Fixed Effects in the Econometric Literature</a></li>
<li class="chapter" data-level="8.5.2" data-path="lme.html"><a href="lme.html#relation-to-generalized-least-squares-gls"><i class="fa fa-check"></i><b>8.5.2</b> Relation to Generalized Least Squares (GLS)</a></li>
<li class="chapter" data-level="8.5.3" data-path="lme.html"><a href="lme.html#relation-to-conditional-gaussian-fields"><i class="fa fa-check"></i><b>8.5.3</b> Relation to Conditional Gaussian Fields</a></li>
<li class="chapter" data-level="8.5.4" data-path="lme.html"><a href="lme.html#relation-to-empirical-risk-minimization-erm"><i class="fa fa-check"></i><b>8.5.4</b> Relation to Empirical Risk Minimization (ERM)</a></li>
<li class="chapter" data-level="8.5.5" data-path="lme.html"><a href="lme.html#relation-to-m-estimation"><i class="fa fa-check"></i><b>8.5.5</b> Relation to M-Estimation</a></li>
<li class="chapter" data-level="8.5.6" data-path="lme.html"><a href="lme.html#relation-to-generalize-estimating-equations-gee"><i class="fa fa-check"></i><b>8.5.6</b> Relation to Generalize Estimating Equations (GEE)</a></li>
<li class="chapter" data-level="8.5.7" data-path="lme.html"><a href="lme.html#relation-to-generalized-method-of-moments-gmm"><i class="fa fa-check"></i><b>8.5.7</b> Relation to Generalized Method of Moments (GMM)</a></li>
<li class="chapter" data-level="8.5.8" data-path="lme.html"><a href="lme.html#manova"><i class="fa fa-check"></i><b>8.5.8</b> Relation to MANOVA</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="lme.html"><a href="lme.html#the-variance-components-view"><i class="fa fa-check"></i><b>8.6</b> The Variance-Components View</a></li>
<li class="chapter" data-level="8.7" data-path="lme.html"><a href="lme.html#bibliographic-notes-6"><i class="fa fa-check"></i><b>8.7</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="8.8" data-path="lme.html"><a href="lme.html#practice-yourself-5"><i class="fa fa-check"></i><b>8.8</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multivariate.html"><a href="multivariate.html"><i class="fa fa-check"></i><b>9</b> Multivariate Data Analysis</a><ul>
<li class="chapter" data-level="9.1" data-path="multivariate.html"><a href="multivariate.html#signal-detection"><i class="fa fa-check"></i><b>9.1</b> Signal Detection</a><ul>
<li class="chapter" data-level="9.1.1" data-path="multivariate.html"><a href="multivariate.html#hotellings-t2-test"><i class="fa fa-check"></i><b>9.1.1</b> Hotelling’s T2 Test</a></li>
<li class="chapter" data-level="9.1.2" data-path="multivariate.html"><a href="multivariate.html#various-types-of-signal-to-detect"><i class="fa fa-check"></i><b>9.1.2</b> Various Types of Signal to Detect</a></li>
<li class="chapter" data-level="9.1.3" data-path="multivariate.html"><a href="multivariate.html#simes-test"><i class="fa fa-check"></i><b>9.1.3</b> Simes’ Test</a></li>
<li class="chapter" data-level="9.1.4" data-path="multivariate.html"><a href="multivariate.html#signal-detection-with-r"><i class="fa fa-check"></i><b>9.1.4</b> Signal Detection with R</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="multivariate.html"><a href="multivariate.html#signal-counting"><i class="fa fa-check"></i><b>9.2</b> Signal Counting</a></li>
<li class="chapter" data-level="9.3" data-path="multivariate.html"><a href="multivariate.html#identification"><i class="fa fa-check"></i><b>9.3</b> Signal Identification</a><ul>
<li class="chapter" data-level="9.3.1" data-path="multivariate.html"><a href="multivariate.html#signal-identification-in-r"><i class="fa fa-check"></i><b>9.3.1</b> Signal Identification in R</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="multivariate.html"><a href="multivariate.html#signal-estimation"><i class="fa fa-check"></i><b>9.4</b> Signal Estimation (*)</a></li>
<li class="chapter" data-level="9.5" data-path="multivariate.html"><a href="multivariate.html#multivariate-regression"><i class="fa fa-check"></i><b>9.5</b> Multivariate Regression (*)</a><ul>
<li class="chapter" data-level="9.5.1" data-path="multivariate.html"><a href="multivariate.html#multivariate-regression-with-r"><i class="fa fa-check"></i><b>9.5.1</b> Multivariate Regression with R</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="multivariate.html"><a href="multivariate.html#graphical-models"><i class="fa fa-check"></i><b>9.6</b> Graphical Models (*)</a><ul>
<li class="chapter" data-level="9.6.1" data-path="multivariate.html"><a href="multivariate.html#graphical-models-in-r"><i class="fa fa-check"></i><b>9.6.1</b> Graphical Models in R</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="multivariate.html"><a href="multivariate.html#biblipgraphic-notes"><i class="fa fa-check"></i><b>9.7</b> Biblipgraphic Notes</a></li>
<li class="chapter" data-level="9.8" data-path="multivariate.html"><a href="multivariate.html#practice-yourself-6"><i class="fa fa-check"></i><b>9.8</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>10</b> Plotting</a><ul>
<li class="chapter" data-level="10.1" data-path="plotting.html"><a href="plotting.html#the-graphics-system"><i class="fa fa-check"></i><b>10.1</b> The graphics System</a><ul>
<li class="chapter" data-level="10.1.1" data-path="plotting.html"><a href="plotting.html#using-existing-plotting-functions"><i class="fa fa-check"></i><b>10.1.1</b> Using Existing Plotting Functions</a></li>
<li class="chapter" data-level="10.1.2" data-path="plotting.html"><a href="plotting.html#exporting-a-plot"><i class="fa fa-check"></i><b>10.1.2</b> Exporting a Plot</a></li>
<li class="chapter" data-level="10.1.3" data-path="plotting.html"><a href="plotting.html#fancy"><i class="fa fa-check"></i><b>10.1.3</b> Fancy graphics Examples</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="plotting.html"><a href="plotting.html#the-ggplot2-system"><i class="fa fa-check"></i><b>10.2</b> The ggplot2 System</a><ul>
<li class="chapter" data-level="10.2.1" data-path="plotting.html"><a href="plotting.html#extensions-of-the-ggplot2-system"><i class="fa fa-check"></i><b>10.2.1</b> Extensions of the ggplot2 System</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="plotting.html"><a href="plotting.html#interactive-graphics"><i class="fa fa-check"></i><b>10.3</b> Interactive Graphics</a><ul>
<li class="chapter" data-level="10.3.1" data-path="plotting.html"><a href="plotting.html#plotly"><i class="fa fa-check"></i><b>10.3.1</b> Plotly</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="plotting.html"><a href="plotting.html#bibliographic-notes-7"><i class="fa fa-check"></i><b>10.4</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="10.5" data-path="plotting.html"><a href="plotting.html#practice-yourself-7"><i class="fa fa-check"></i><b>10.5</b> Practice Yourself</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>11</b> Reports</a><ul>
<li class="chapter" data-level="11.1" data-path="report.html"><a href="report.html#knitr"><i class="fa fa-check"></i><b>11.1</b> knitr</a><ul>
<li class="chapter" data-level="11.1.1" data-path="report.html"><a href="report.html#installation"><i class="fa fa-check"></i><b>11.1.1</b> Installation</a></li>
<li class="chapter" data-level="11.1.2" data-path="report.html"><a href="report.html#pandoc-markdown"><i class="fa fa-check"></i><b>11.1.2</b> Pandoc Markdown</a></li>
<li class="chapter" data-level="11.1.3" data-path="report.html"><a href="report.html#rmarkdown"><i class="fa fa-check"></i><b>11.1.3</b> Rmarkdown</a></li>
<li class="chapter" data-level="11.1.4" data-path="report.html"><a href="report.html#bibtex"><i class="fa fa-check"></i><b>11.1.4</b> BibTex</a></li>
<li class="chapter" data-level="11.1.5" data-path="report.html"><a href="report.html#compiling"><i class="fa fa-check"></i><b>11.1.5</b> Compiling</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="report.html"><a href="report.html#bookdown"><i class="fa fa-check"></i><b>11.2</b> bookdown</a></li>
<li class="chapter" data-level="11.3" data-path="report.html"><a href="report.html#shiny"><i class="fa fa-check"></i><b>11.3</b> Shiny</a><ul>
<li class="chapter" data-level="11.3.1" data-path="report.html"><a href="report.html#installation-1"><i class="fa fa-check"></i><b>11.3.1</b> Installation</a></li>
<li class="chapter" data-level="11.3.2" data-path="report.html"><a href="report.html#the-basics-of-shiny"><i class="fa fa-check"></i><b>11.3.2</b> The Basics of Shiny</a></li>
<li class="chapter" data-level="11.3.3" data-path="report.html"><a href="report.html#beyond-the-basics"><i class="fa fa-check"></i><b>11.3.3</b> Beyond the Basics</a></li>
<li class="chapter" data-level="11.3.4" data-path="report.html"><a href="report.html#shinydashboard"><i class="fa fa-check"></i><b>11.3.4</b> shinydashboard</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="report.html"><a href="report.html#flexdashboard"><i class="fa fa-check"></i><b>11.4</b> flexdashboard</a></li>
<li class="chapter" data-level="11.5" data-path="report.html"><a href="report.html#bibliographic-notes-8"><i class="fa fa-check"></i><b>11.5</b> Bibliographic Notes</a></li>
<li class="chapter" data-level="11.6" data-path="report.html"><a href="report.html#practice-yourself-8"><i class="fa fa-check"></i><b>11.6</b> Practice Yourself</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R (BGU course)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="eda" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Exploratory Data Analysis</h1>
<p>Exploratory Data Analysis (EDA) is a term coined by <a href="https://en.wikipedia.org/wiki/John_Tukey">John W. Tukey</a> in his seminal book <span class="citation">(Tukey <a href="#ref-tukey1977exploratory">1977</a>)</span>. It is also (arguably) known as <em>Visual Analytics</em>, or <em>Descriptive Statistics</em>. It is the practice of inspecting, and exploring your data, before stating hypotheses, fitting predictors, and other more ambitious inferential goals. It typically includes the computation of simple <em>summary statistics</em> which capture some property of interest in the data, and <em>visualization</em>. EDA can be thought of as an assumption free, purely algorithmic practice.</p>
<p>In this text we present EDA techniques along the following lines:</p>
<ul>
<li>How we explore: with summary-statistics, or visually?</li>
<li>How many variables analyzed simultaneously: univariate, bivariate, or multivariate?</li>
<li>What type of variable: categorical or continuous?</li>
</ul>
<div id="summary-statistics" class="section level2">
<h2><span class="header-section-number">5.1</span> Summary Statistics</h2>
<div id="categorical-data" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Categorical Data</h3>
<p>Categorical variables do not admit any mathematical operations on them. We cannot sum them, or even sort them. We can only <strong>count</strong> them. As such, summaries of categorical variables will always start with the counting of the frequency of each category.</p>
<div id="summary-of-univariate-categorical-data" class="section level4">
<h4><span class="header-section-number">5.1.1.1</span> Summary of Univariate Categorical Data</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make some data</span>
gender &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;Boy&#39;</span>, <span class="dv">10</span>), <span class="kw">rep</span>(<span class="st">&#39;Girl&#39;</span>, <span class="dv">12</span>))
drink &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;Coke&#39;</span>, <span class="dv">5</span>), <span class="kw">rep</span>(<span class="st">&#39;Sprite&#39;</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="st">&#39;Coffee&#39;</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="st">&#39;Tea&#39;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&#39;Water&#39;</span>, <span class="dv">1</span>))  
age &lt;-<span class="st">  </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&#39;Young&#39;</span>, <span class="st">&#39;Old&#39;</span>), <span class="dt">size =</span> <span class="kw">length</span>(gender), <span class="dt">replace =</span> <span class="ot">TRUE</span>)
<span class="co"># Count frequencies</span>
<span class="kw">table</span>(gender)</code></pre></div>
<pre><code>## gender
##  Boy Girl 
##   10   12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(drink)</code></pre></div>
<pre><code>## drink
## Coffee   Coke Sprite    Tea  Water 
##      6      5      3      7      1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(age)</code></pre></div>
<pre><code>## age
##   Old Young 
##    11    11</code></pre>
<p>If instead of the level counts you want the proportions, you can use <code>prop.table</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(gender))</code></pre></div>
<pre><code>## gender
##       Boy      Girl 
## 0.4545455 0.5454545</code></pre>
</div>
<div id="summary-of-bivariate-categorical-data" class="section level4">
<h4><span class="header-section-number">5.1.1.2</span> Summary of Bivariate Categorical Data</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(magrittr)
<span class="kw">cbind</span>(gender, drink) <span class="op">%&gt;%</span><span class="st"> </span>head <span class="co"># bind vectors into matrix and inspect</span></code></pre></div>
<pre><code>##      gender drink   
## [1,] &quot;Boy&quot;  &quot;Coke&quot;  
## [2,] &quot;Boy&quot;  &quot;Coke&quot;  
## [3,] &quot;Boy&quot;  &quot;Coke&quot;  
## [4,] &quot;Boy&quot;  &quot;Coke&quot;  
## [5,] &quot;Boy&quot;  &quot;Coke&quot;  
## [6,] &quot;Boy&quot;  &quot;Sprite&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table1 &lt;-<span class="st"> </span><span class="kw">table</span>(gender, drink) <span class="co"># count frequencies of bivariate combinations</span>
table1                                      </code></pre></div>
<pre><code>##       drink
## gender Coffee Coke Sprite Tea Water
##   Boy       2    5      3   0     0
##   Girl      4    0      0   7     1</code></pre>
</div>
<div id="summary-of-multivariate-categorical-data" class="section level4">
<h4><span class="header-section-number">5.1.1.3</span> Summary of Multivariate Categorical Data</h4>
<p>You may be wondering how does R handle tables with more than two dimensions. It is indeed not trivial to report this in a human-readable way. R offers several solutions: <code>table</code> is easier to compute with, and <code>ftable</code> is human readable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table2.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">table</span>(gender, drink, age) <span class="co"># A machine readable table. </span>
table2.<span class="dv">1</span></code></pre></div>
<pre><code>## , , age = Old
## 
##       drink
## gender Coffee Coke Sprite Tea Water
##   Boy       1    2      1   0     0
##   Girl      3    0      0   3     1
## 
## , , age = Young
## 
##       drink
## gender Coffee Coke Sprite Tea Water
##   Boy       1    3      2   0     0
##   Girl      1    0      0   4     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table.<span class="fl">2.2</span> &lt;-<span class="st"> </span><span class="kw">ftable</span>(gender, drink, age) <span class="co"># A human readable table.</span>
table.<span class="fl">2.2</span></code></pre></div>
<pre><code>##               age Old Young
## gender drink               
## Boy    Coffee       1     1
##        Coke         2     3
##        Sprite       1     2
##        Tea          0     0
##        Water        0     0
## Girl   Coffee       3     1
##        Coke         0     0
##        Sprite       0     0
##        Tea          3     4
##        Water        1     0</code></pre>
<p>If you want proportions instead of counts, you need to specify the denominator, i.e., the margins. Think: what is the margin in each of the following outputs?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(table1, <span class="dt">margin =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>##       drink
## gender     Coffee       Coke     Sprite        Tea      Water
##   Boy  0.20000000 0.50000000 0.30000000 0.00000000 0.00000000
##   Girl 0.33333333 0.00000000 0.00000000 0.58333333 0.08333333</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(table1, <span class="dt">margin =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>##       drink
## gender    Coffee      Coke    Sprite       Tea     Water
##   Boy  0.3333333 1.0000000 1.0000000 0.0000000 0.0000000
##   Girl 0.6666667 0.0000000 0.0000000 1.0000000 1.0000000</code></pre>
</div>
</div>
<div id="continous-data" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Continous Data</h3>
<p>Continuous variables admit many more operations than categorical. We can compute sums, means, quantiles, and more.</p>
<div id="summary-of-univariate-continuous-data" class="section level4">
<h4><span class="header-section-number">5.1.2.1</span> Summary of Univariate Continuous Data</h4>
<p>We distinguish between several types of summaries, each capturing a different property of the data.</p>
</div>
<div id="summary-of-location" class="section level4">
<h4><span class="header-section-number">5.1.2.2</span> Summary of Location</h4>
<p>Capture the “location” of the data. These include:</p>

<div class="definition">
<span id="def:unnamed-chunk-97" class="definition"><strong>Definition 5.1  (Average)  </strong></span>The mean, or average, of a sample <span class="math inline">\(x:=(x_1,\dots,x_n)\)</span>, denoted <span class="math inline">\(\bar x\)</span> is defined as <span class="math display">\[ \bar x := n^{-1} \sum x_i. \]</span>
</div>

<p>The sample mean is <strong>non robust</strong>. A single large observation may inflate the mean indefinitely. For this reason, we define several other summaries of location, which are more robust, i.e., less affected by “contaminations” of the data.</p>
<p>We start by defining the sample quantiles, themselves <strong>not</strong> a summary of location.</p>

<div class="definition">
<span id="def:unnamed-chunk-98" class="definition"><strong>Definition 5.2  (Quantiles)  </strong></span>The <span class="math inline">\(\alpha\)</span> quantile of a sample <span class="math inline">\(x\)</span>, denoted <span class="math inline">\(x_\alpha\)</span>, is (non uniquely) defined as a value above <span class="math inline">\(100 \alpha \%\)</span> of the sample, and below <span class="math inline">\(100 (1-\alpha) \%\)</span>.
</div>

<p>We emphasize that sample quantiles are non-uniquely defined. See <code>?quantile</code> for the 9(!) different definitions that R provides.</p>
<p>Using the sample quantiles, we can now define another summary of location, the <strong>median</strong>.</p>

<div class="definition">
<span id="def:unnamed-chunk-99" class="definition"><strong>Definition 5.3  (Median)  </strong></span>The median of a sample <span class="math inline">\(x\)</span>, denoted <span class="math inline">\(x_{0.5}\)</span> is the <span class="math inline">\(\alpha=0.5\)</span> quantile of the sample.
</div>

<p>A whole family of summaries of locations is the <strong>alpha trimmed mean</strong>.</p>

<div class="definition">
<span id="def:unnamed-chunk-100" class="definition"><strong>Definition 5.4  (Alpha Trimmed Mean)  </strong></span>The <span class="math inline">\(\alpha\)</span> trimmed mean of a sample <span class="math inline">\(x\)</span>, denoted <span class="math inline">\(\bar x_\alpha\)</span> is the average of the sample after removing the <span class="math inline">\(\alpha\)</span> proportion of largest and <span class="math inline">\(\alpha\)</span> proportion of smallest observations.
</div>

<p>The simple mean and median are instances of the alpha trimmed mean: <span class="math inline">\(\bar x_0\)</span> and <span class="math inline">\(\bar x_{0.5}\)</span> respectively.</p>
<p>Here are the R implementations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">100</span>) <span class="co"># generate some random data</span>
<span class="kw">mean</span>(x) <span class="co"># simple mean</span></code></pre></div>
<pre><code>## [1] 1.088972</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(x) <span class="co"># median</span></code></pre></div>
<pre><code>## [1] 0.7839536</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(x, <span class="dt">trim =</span> <span class="fl">0.2</span>) <span class="co"># alpha trimmed mean with alpha=0.2</span></code></pre></div>
<pre><code>## [1] 0.8199521</code></pre>
</div>
<div id="summary-of-scale" class="section level4">
<h4><span class="header-section-number">5.1.2.3</span> Summary of Scale</h4>
<p>The <em>scale</em> of the data, sometimes known as <em>spread</em>, can be thought of its variability.</p>

<div class="definition">
<span id="def:unnamed-chunk-102" class="definition"><strong>Definition 5.5  (Standard Deviation)  </strong></span>The standard deviation of a sample <span class="math inline">\(x\)</span>, denoted <span class="math inline">\(S(x)\)</span>, is defined as <span class="math display">\[ S(x):=\sqrt{(n-1)^{-1} \sum (x_i-\bar x)^2} . \]</span>
</div>

<p>For reasons of robustness, we define other, more robust, measures of scale.</p>

<div class="definition">
<span id="def:unnamed-chunk-103" class="definition"><strong>Definition 5.6  (MAD)  </strong></span>The Median Absolute Deviation from the median, denoted as <span class="math inline">\(MAD(x)\)</span>, is defined as <span class="math display">\[MAD(x):= c \: |x-x_{0.5}|_{0.5} . \]</span>
</div>

<p>where <span class="math inline">\(c\)</span> is some constant, typically set to <span class="math inline">\(c=1.4826\)</span> so that MAD and <span class="math inline">\(S(x)\)</span> have the same large sample limit.</p>

<div class="definition">
<span id="def:unnamed-chunk-104" class="definition"><strong>Definition 5.7  (IQR)  </strong></span>The Inter Quantile Range of a sample <span class="math inline">\(x\)</span>, denoted as <span class="math inline">\(IQR(x)\)</span>, is defined as <span class="math display">\[ IQR(x):= x_{0.75}-x_{0.25} .\]</span>
</div>

<p>Here are the R implementations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(x) <span class="co"># standard deviation</span></code></pre></div>
<pre><code>## [1] 1.068415</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mad</span>(x) <span class="co"># MAD</span></code></pre></div>
<pre><code>## [1] 0.7083485</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">IQR</span>(x) <span class="co"># IQR</span></code></pre></div>
<pre><code>## [1] 0.9869843</code></pre>
</div>
<div id="summary-of-asymmetry" class="section level4">
<h4><span class="header-section-number">5.1.2.4</span> Summary of Asymmetry</h4>
<p>Summaries of asymmetry, also known as <em>skewness</em>, quantify the departure of the <span class="math inline">\(x\)</span> from a symmetric sample.</p>

<div class="definition">
<span id="def:unnamed-chunk-106" class="definition"><strong>Definition 5.8  (Yule)  </strong></span>The Yule measure of assymetry, denoted <span class="math inline">\(Yule(x)\)</span> is defined as <span class="math display">\[Yule(x) := \frac{1/2 \: (x_{0.75}+x_{0.25}) - x_{0.5} }{1/2 \: IQR(x)} .\]</span>
</div>

<p>Here is an R implementation</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">yule &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  numerator &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">quantile</span>(x,<span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span><span class="kw">quantile</span>(x,<span class="fl">0.25</span>))<span class="op">-</span><span class="kw">median</span>(x) 
  denominator &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="st"> </span><span class="kw">IQR</span>(x)
  <span class="kw">c</span>(numerator<span class="op">/</span>denominator, <span class="dt">use.names=</span><span class="ot">FALSE</span>)
}
<span class="kw">yule</span>(x)</code></pre></div>
<pre><code>## [1] 0.2317222</code></pre>
</div>
<div id="summary-of-bivariate-continuous-data" class="section level4">
<h4><span class="header-section-number">5.1.2.5</span> Summary of Bivariate Continuous Data</h4>
<p>When dealing with bivariate, or multivariate data, we can obviously compute univariate summaries for each variable separately. This is not the topic of this section, in which we want to summarize the association <strong>between</strong> the variables, and not within them.</p>

<div class="definition">
<span id="def:unnamed-chunk-107" class="definition"><strong>Definition 5.9  (Covariance)  </strong></span>The covariance between two samples, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, of same length <span class="math inline">\(n\)</span>, is defined as <span class="math display">\[Cov(x,y):= (n-1)^{-1} \sum (x_i-\bar x)(y_i-\bar y)  \]</span>
</div>

<p>We emphasize this is not the covariance you learned about in probability classes, since it is not the covariance between two <em>random variables</em> but rather, between two <em>samples</em>. For this reasons, some authors call it the <em>empirical covariance</em>, or <em>sample covariance</em>.</p>

<div class="definition">
<span id="def:unnamed-chunk-108" class="definition"><strong>Definition 5.10  (Pearson’s Correlation Coefficient)  </strong></span>Peasrson’s correlation coefficient, a.k.a. Pearson’s moment product correlation, or simply, the correlation, denoted <code>r(x,y)</code>, is defined as <span class="math display">\[r(x,y):=\frac{Cov(x,y)}{S(x)S(y)}. \]</span>
</div>

<p>If you find this definition enigmatic, just think of the correlation as the covariance between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> after transforming each to the unitless scale of z-scores.</p>

<div class="definition">
<span id="def:unnamed-chunk-109" class="definition"><strong>Definition 5.11  (Z-Score)  </strong></span>The z-scores of a sample <span class="math inline">\(x\)</span> are defined as the mean-centered, scale normalized observations: <span class="math display">\[z_i(x):= \frac{x_i-\bar x}{S(x)}.\]</span>
</div>

<p>We thus have that <span class="math inline">\(r(x,y)=Cov(z(x),z(y))\)</span>.</p>
</div>
<div id="summary-of-multivariate-continuous-data" class="section level4">
<h4><span class="header-section-number">5.1.2.6</span> Summary of Multivariate Continuous Data</h4>
<p>The covariance is a simple summary of association between two variables, but it certainly may not capture the whole “story” when dealing with more than two variables. The most common summary of multivariate relation, is the <strong>covariance matrix</strong>, but we warn that only the simplest multivariate relations are fully summarized by this matrix.</p>

<div class="definition">
<span id="def:unnamed-chunk-110" class="definition"><strong>Definition 5.12  (Sample Covariance Matrix)  </strong></span>Given <span class="math inline">\(n\)</span> observations on <span class="math inline">\(p\)</span> variables, denote <span class="math inline">\(x_{i,j}\)</span> the <span class="math inline">\(i\)</span>’th observation of the <span class="math inline">\(j\)</span>’th variable. The <em>sample covariance matrix</em>, denoted <span class="math inline">\(\hat \Sigma\)</span> is defined as <span class="math display">\[\hat \Sigma_{k,l}=(n-1)^{-1} \sum_i [(x_{i,k}-\bar x_k)(x_{i,l}-\bar x_l)],\]</span> where <span class="math inline">\(\bar x_k:=n^{-1} \sum_i x_{i,k}\)</span>. Put differently, the <span class="math inline">\(k,l\)</span>’th entry in <span class="math inline">\(\hat \Sigma\)</span> is the sample covariance between variables <span class="math inline">\(k\)</span> and <span class="math inline">\(l\)</span>.
</div>


<div class="remark">
 <span class="remark"><em>Remark. </em></span> <span class="math inline">\(\hat \Sigma\)</span> is clearly non robust. How would you define a robust covariance matrix?
</div>

</div>
</div>
</div>
<div id="visualization" class="section level2">
<h2><span class="header-section-number">5.2</span> Visualization</h2>
<p>Summarizing the information in a variable to a single number clearly conceals much of the story in the sample. This is akin to inspecting a person using a caricature, instead of a picture. Visualizing the data, when possible, is more informative.</p>
<div id="categorical-data-1" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Categorical Data</h3>
<p>Recalling that with categorical variables we can only count the frequency of each level, the plotting of such variables are typically variations on the <em>bar plot</em>.</p>
<div id="visualizing-univariate-categorical-data" class="section level4">
<h4><span class="header-section-number">5.2.1.1</span> Visualizing Univariate Categorical Data</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">table</span>(age))</code></pre></div>
<p><img src="Rcourse_files/figure-html/barplot-1.png" width="50%" /></p>
</div>
<div id="visualizing-bivariate-categorical-data" class="section level4">
<h4><span class="header-section-number">5.2.1.2</span> Visualizing Bivariate Categorical Data</h4>
<p>There are several generalizations of the barplot, aimed to deal with the visualization of bivariate categorical data. They are sometimes known as the <em>clustered bar plot</em> and the <em>stacked bar plot</em>. In this text, we advocate the use of the <em>mosaic plot</em> which is also the default in R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(table1, <span class="dt">main=</span><span class="st">&#39;Bivariate mosaic plot&#39;</span>)</code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-112-1.png" width="50%" /></p>
</div>
<div id="visualizing-multivariate-categorical-data" class="section level4">
<h4><span class="header-section-number">5.2.1.3</span> Visualizing Multivariate Categorical Data</h4>
<p>The <em>mosaic plot</em> is not easy to generalize to more than two variables, but it is still possible (at the cost of interpretability).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(table2.<span class="dv">1</span>, <span class="dt">main=</span><span class="st">&#39;Trivaraite mosaic plot&#39;</span>)</code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-113-1.png" width="50%" /></p>
</div>
</div>
<div id="continuous-data" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Continuous Data</h3>
<div id="visualizing-univariate-continuous-data" class="section level4">
<h4><span class="header-section-number">5.2.2.1</span> Visualizing Univariate Continuous Data</h4>
<p>Unlike categorical variables, there are endlessly many way to visualize continuous variables. The simplest way is to look at the raw data via the <code>stripchart</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">10</span>)                             
<span class="kw">stripchart</span>(sample1)</code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-114-1.png" width="50%" /></p>
<p>Clearly, if there are many observations, the <code>stripchart</code> will be a useless line of black dots. We thus bin them together, and look at the frequency of each bin; this is the <em>histogram</em>. R’s <code>histogram</code> function has very good defaults to choose the number of bins. Here is a histogram showing the counts of each bin.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">100</span>)                            
<span class="kw">hist</span>(sample1, <span class="dt">freq=</span>T, <span class="dt">main=</span><span class="st">&#39;Counts&#39;</span>)        </code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-115-1.png" width="50%" /></p>
<p>The bin counts can be replaced with the proportion of each bin using the <code>freq</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(sample1, <span class="dt">freq=</span>F, <span class="dt">main=</span><span class="st">&#39;Proportion&#39;</span>)    </code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-116-1.png" width="50%" /></p>
<p>The bins of a histogram are non overlapping. We can adopt a sliding window approach, instead of binning. This is the <em>density plot</em> which is produced with the <code>density</code> function, and added to an existing plot with the <code>lines</code> function. The <code>rug</code> function adds the original data points as ticks on the axes, and is strongly recommended to detect artifacts introduced by the binning of the histogram, or the smoothing of the density plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(sample1, <span class="dt">freq=</span>F, <span class="dt">main=</span><span class="st">&#39;Frequencies&#39;</span>)   
<span class="kw">lines</span>(<span class="kw">density</span>(sample1))                     
<span class="kw">rug</span>(sample1)</code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-117-1.png" width="50%" /></p>

<div class="remark">
 <span class="remark"><em>Remark. </em></span> Why would it make no sense to make a table, or a barplot, of continuous data?
</div>

<p>One particularly useful visualization, due to John W. Tukey, is the <em>boxplot</em>. The boxplot is designed to capture the main phenomena in the data, and simultaneously point to outlines.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(sample1)    </code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-119-1.png" width="50%" /></p>
</div>
<div id="visualizing-bivariate-continuous-data" class="section level4">
<h4><span class="header-section-number">5.2.2.2</span> Visualizing Bivariate Continuous Data</h4>
<p>The bivariate counterpart of the <code>stipchart</code> is the celebrated scatter plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">20</span>
x1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)
x2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw">rexp</span>(n)
<span class="kw">plot</span>(x2<span class="op">~</span>x1)</code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-120-1.png" width="50%" /></p>
<p>Like the univariate <code>stripchart</code>, the scatter plot will be an uninformative mess in the presence of a lot of data. A nice bivariate counterpart of the univariate histogram is the <em>hexbin plot</em>, which tessellates the plane with hexagons, and reports their frequencies.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(hexbin) <span class="co"># load required library</span>
n &lt;-<span class="st"> </span><span class="fl">2e5</span>
x1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)
x2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)
<span class="kw">plot</span>(<span class="kw">hexbin</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2))</code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-121-1.png" width="50%" /></p>
</div>
<div id="visualizing-multivariate-continuous-data" class="section level4">
<h4><span class="header-section-number">5.2.2.3</span> Visualizing Multivariate Continuous Data</h4>
<p>Visualizing multivariate data is a tremendous challenge given that we cannot grasp <span class="math inline">\(4\)</span> dimensional spaces, nor can the computer screen present more than <span class="math inline">\(2\)</span> dimensional spaces. We thus have several options: (i) To project the data to 2D. This is discussed in the Dimensionality Reduction Section <a href="#dim-reduce"><strong>??</strong></a>. (ii) To visualize not the raw data, but rather its summaries, like the covariance matrix.</p>
<p>Since the covariance matrix, <span class="math inline">\(\hat \Sigma\)</span> is a matrix, it can be visualized as an image. Note the use of the <code>::</code> operator, which is used to call a function from some package, without loading the whole package. We will use the <code>::</code> operator when we want to emphasize the package of origin of a function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">covariance &lt;-<span class="st"> </span><span class="kw">cov</span>(longley) <span class="co"># The covariance of the longley dataset</span>
correlations &lt;-<span class="st"> </span><span class="kw">cor</span>(longley) <span class="co"># The correlations of the longley dataset</span>
lattice<span class="op">::</span><span class="kw">levelplot</span>(correlations)</code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-122-1.png" width="50%" /></p>
</div>
<div id="parcoord" class="section level4">
<h4><span class="header-section-number">5.2.2.4</span> Parallel Coordinate Plots</h4>
<p>TODO</p>
</div>
</div>
</div>
<div id="mixed-type-data" class="section level2">
<h2><span class="header-section-number">5.3</span> Mixed Type Data</h2>
<p>Most real data sets will be of mixed type: both categorical and continous. One approach to view such data, is to visualize the continous variables separatly, for each level of the categorical variables. There are, however, interesting dedicated visualization for such data.</p>
<div id="alluvian-diagram" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Alluvian Diagram</h3>
<p>An Alluvian plot is a type of <a href="eda.html#parcoord">Parallel Coordinate Plot</a> for multivariate categorical data. It is particularly interesting when the <span class="math inline">\(x\)</span> axis is a discretized time variable, and it is used to visualize flow.</p>
<p>The following example, from the <strong>ggalluvial</strong> package Vignette by <a href="https://cran.r-project.org/web/packages/ggalluvial/vignettes/ggalluvial.html">Jason Cory Brunson</a>, demonstrates the flow of students between different majors, as semesters evolve.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggalluvial)
<span class="kw">data</span>(majors)
majors<span class="op">$</span>curriculum &lt;-<span class="st"> </span><span class="kw">as.factor</span>(majors<span class="op">$</span>curriculum)
<span class="kw">ggplot</span>(majors,
       <span class="kw">aes</span>(<span class="dt">x =</span> semester, <span class="dt">stratum =</span> curriculum, <span class="dt">alluvium =</span> student,
           <span class="dt">fill =</span> curriculum, <span class="dt">label =</span> curriculum)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_flow</span>(<span class="dt">stat =</span> <span class="st">&quot;alluvium&quot;</span>, <span class="dt">lode.guidance =</span> <span class="st">&quot;rightleft&quot;</span>,
            <span class="dt">color =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_stratum</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;student curricula across several semesters&quot;</span>)</code></pre></div>
<p><img src="Rcourse_files/figure-html/unnamed-chunk-123-1.png" width="50%" /></p>
<p>Things to note:</p>
<ul>
<li>We used the <strong>galluvian</strong> package of the <strong>ggplot2</strong> ecosystem. More on <strong>ggplot2</strong> in the <a href="plotting.html#plotting">Plotting Chapter</a>.</li>
<li>Time is on the <span class="math inline">\(x\)</span> axis. Categories are color coded.</li>
</ul>
</div>
</div>
<div id="bibliographic-notes-3" class="section level2">
<h2><span class="header-section-number">5.4</span> Bibliographic Notes</h2>
<p>Like any other topic in this book, you can consult <span class="citation">Venables and Ripley (<a href="#ref-venables2013modern">2013</a>)</span>. The seminal book on EDA, written long before R was around, is <span class="citation">Tukey (<a href="#ref-tukey1977exploratory">1977</a>)</span>. For an excellent text on robust statistics see <span class="citation">Wilcox (<a href="#ref-wilcox2011introduction">2011</a>)</span>.</p>
</div>
<div id="practice-yourself-3" class="section level2">
<h2><span class="header-section-number">5.5</span> Practice Yourself</h2>
<ol style="list-style-type: decimal">
<li><p>Read about the Titanic data set using <code>?Titanic</code>. Inspect it with the <code>table</code> and with the <code>ftable</code> commands. Which do you prefer?</p></li>
<li><p>Inspect the Titanic data with a plot. Start with <code>plot(Titanic)</code> Try also <code>lattice::dotplot</code>. Which is the passenger category with most survivors? Which plot do you prefer? Which scales better to more categories?</p></li>
<li>Read about the women data using <code>?women</code>.
<ol style="list-style-type: decimal">
<li>Compute the average of each variable. What is the average of the heights?</li>
<li>Plot a histogram of the heights. Add ticks using <code>rug</code>.</li>
<li>Plot a boxplot of the weights.</li>
<li>Plot the heights and weights using a scatter plot. Add ticks using <code>rug</code>.</li>
</ol></li>
<li><p>Choose <span class="math inline">\(\alpha\)</span> to define a new symmetry measure: <span class="math inline">\(1/2(x_\alpha+x_{1-\alpha})-x_{0.5}\)</span>. Write a function that computes it, and apply it on women’s heights data.</p></li>
<li><p>Compute the covariance matrix of women’s heights and weights. Compute the correlation matrix. View the correlation matrix as an image using <code>lattice::levelplot</code>.</p></li>
<li><p>Pick a dataset with two LONG continous variables from <code>?datasets</code>. Plot it using <code>hexbin::hexbin</code>.</p></li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-tukey1977exploratory">
<p>Tukey, John W. 1977. <em>Exploratory Data Analysis</em>. Reading, Mass.</p>
</div>
<div id="ref-venables2013modern">
<p>Venables, William N, and Brian D Ripley. 2013. <em>Modern Applied Statistics with S-Plus</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-wilcox2011introduction">
<p>Wilcox, Rand R. 2011. <em>Introduction to Robust Estimation and Hypothesis Testing</em>. Academic Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datatable.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-eda.Rmd",
"text": "Edit"
},
"download": ["Rcourse.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
